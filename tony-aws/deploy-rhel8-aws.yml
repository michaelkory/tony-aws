---
  - name: Deploying AWS instance
    hosts: localhost
    connection: local
    gather_facts: no
    vars:
       ec2_security_group_name: "toharris_sg_satellite"
       my_email_address: "{{user_name}}@redhat.com"   
    vars_files:
    - group_vars/all


    tasks:
    - name: Creating {{target_hostname}} on AWS in the {{region}} region
      ec2:
       key_name: "{{key_name}}"
       instance_type: "{{instance_type}}"
       image:  "{{image}}"
       wait: "{{wait}}"
       group: "{{ec2_security_group_name}}"
       wait_timeout: 500
       count: "{{count}}"
       region: "{{region}}"
       vpc_subnet_id:  "{{vpc_subnet_id}}"
       assign_public_ip: "{{assign_public_ip}}"
       instance_tags:
         AlwaysUp: "{{alwaysup}}"
         Name: "{{target_hostname}}"
         Createdby: Ansible Tower
         Contact: "{{my_email_address}}"
         DeleteBy: "{{deleteby}}"
         Type: "{{group}}"
